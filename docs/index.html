<!DOCTYPE html>

<html>

  <head>
    <meta charset="UTF-8" />
    <meta name="author" content="Jean-Philippe Paradis" />
    <link rel="author" href="https://abc.hexstream.xyz/" />
    <link rel="license" href="https://www.hexstreamsoft.com/UNLICENSE" />
    <meta name="description" content="Parses LOOP's convenient for-as-arithmetic syntax into 5 simple values: from, to, limit-kind (:inclusive, :exclusive or nil if unbounded), by (step) and direction (+ or -))." />
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>parse-number-range | Libraries | HexstreamSoft</title>
    <link href="../../css/global.css" rel="stylesheet" type="text/css" />
    <link href="../libraries.css" rel="stylesheet" type="text/css" />
    <script src="https://global.hexstreamsoft.com/scripts/global.js"></script>
    <script src="../../scripts/global.js"></script>
    <script src="../libraries.js" defer></script>
  </head>

  <body>

    <nav id="top-nav">

      <div class="main">

        <div class="breadcrumbs">
          <a href="../../">HexstreamSoft</a>
          <span class="crumb"><span class="s"> » </span><a href="../">Libraries</a></span>
          <span class="crumb"><span class="s"> » </span><a class="here">parse-number-range</a></span>
        </div>

      </div>

    </nav>

    <main>

      <header id="page-header">
        <h1>parse-number-range</h1>
      </header>

      <div class="tags contains-groups">
        <div class="group prominent">
          <span class="tag hv license">
            <span class="h">License<span>:</span></span>
            <span class="v">Public Domain</span>
          </span>
          <span class="s">, </span>
          <span class="tag github"><a href="http://github.com/Hexstream/parse-number-range">See on GitHub</a></span>
          <span class="s">, </span>
          <span class="tag hv quicklisp">
            <span class="h">Load it with Quicklisp<span>:</span></span>
            <code class="v">(ql:quickload "parse-number-range")</code>
          </span>
        </div>
        <div class="group">
          <span class="tag hv">
            <span class="h">Library type<span>:</span></span>
            <span class="v">Thematic utilities</span>
          </span>
          <span class="s">, </span>
          <span class="tag hv">
            <span class="h">Project complexity<span>:</span></span>
            <span class="v">Simple</span>
          </span>
        </div>
      </div>

      <nav class="tabs" id="further-info">
        <ul>
          <li><a href="../releases/latest-versions/#parse-number-range">Latest release</a></li>
          <li><a href="../dependencies/#parse-number-range">Dependencies</a></li>
        </ul>
        <ul>
          <li><a href="../external-pages-xref/#parse-number-range">External library pages</a></li>
        </ul>
      </nav>

      <section id="introduction">

        <p><cite class="common-lisp library">parse-number-range</cite> parses <code class="common-lisp standard macro operator"><a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_loop.htm">loop</a></code>'s convenient <a href="http://www.lispworks.com/documentation/HyperSpec/Body/06_abaa.htm">for-as-arithmetic</a> syntax into 5 simple values: <var>from</var>, <var>to</var>, <var>limit-kind</var> (<code class="common-lisp library marker">:inclusive</code>, <code class="common-lisp library marker">:exclusive</code> or <code class="common-lisp library marker">nil</code> if unbounded), <var>by</var> (step) and <var>direction</var> (<code class="common-lisp library marker">+</code> or <code class="common-lisp library marker">-</code>)).<br />Further related utilities are provided. Intended for easy implementation of analogous functionality in other constructs.</p>

      </section>

      <p>Here's the package name, along with 2 nicknames:</p>

      <ul>
        <li><code class="common-lisp library package">parse-number-range</code></li>
        <li><code class="common-lisp library package">parse-numrange</code></li>
        <li><code class="common-lisp library package">pnumrange</code></li>
      </ul>

      <p>Explicit qualification of the exported symbols is recommended, and one might <code class="common-lisp">(<a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_defpkg.htm">:import-from</a>)</code> select symbols, but <code class="common-lisp">(<a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_defpkg.htm">:use</a>)</code> is strongly discouraged.</p>

      <section id="api">

        <h1 class="breadcrumbs-bar">
          <span class="section-relative-nav">
            <a href="#api" class="anchor">⚓</a>
          </span>
          <span class="breadcrumbs">
            <a href="#">parse-number-range</a>
            <span class="crumb"><span class="s"> » </span><a class="here">API</a></span>
          </span>
        </h1>

        <section id="api-generalities">

          <h1 class="breadcrumbs-bar">
            <span class="section-relative-nav">
              <a href="#api-generalities" class="anchor">⚓</a>
            </span>
            <span class="breadcrumbs">
              <a href="#">parse-number-range</a>
              <span class="crumb"><span class="s"> » </span><a href="#api">API</a></span>
              <span class="crumb"><span class="s"> » </span><a class="here">Generalities</a></span>
            </span>
          </h1>

          <p>Here are the 5 "fundamental" values returned from <code class="common-lisp library function operator">parse</code> and accepted by <code class="common-lisp library function operator">unparse</code>:</p>

          <dl>

            <dt><dfn><var>from</var></dfn></dt>
            <dd><p>The <a class="common-lisp glossary" href="http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_f.htm#form">form</a> introduced by <code class="common-lisp library marker">:from</code>, <code class="common-lisp library marker">:upfrom</code> or <code class="common-lisp library marker">:downfrom</code>. Defaults to 0;</p></dd>

            <dt><dfn><var>to</var></dfn></dt>
            <dd><p>The <a class="common-lisp glossary" href="http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_f.htm#form">form</a> introduced by <code class="common-lisp library marker">:to</code>, <code class="common-lisp library marker">:upto</code>, <code class="common-lisp library marker">:downto</code>, <code class="common-lisp library marker">:below</code> or <code class="common-lisp library marker">:above</code>. <code class="common-lisp library marker">nil</code> means "unbounded";</p></dd>

            <dt><dfn><var>limit-kind</var></dfn></dt>
            <dd><p><code class="common-lisp library marker">:inclusive</code> or <code class="common-lisp library marker">:exclusive</code> if there's a limit, or <code class="common-lisp library marker">nil</code> if unbounded;</p></dd>

            <dt><dfn><var>by</var></dfn></dt>
            <dd><p>The <a class="common-lisp glossary" href="http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_f.htm#form">form</a> introduced by <code class="common-lisp library marker">:by</code>;</p></dd>

            <dt><dfn><var>direction</var></dfn></dt>
            <dd><p><code class="common-lisp library marker">+</code> or <code class="common-lisp library marker">-</code>.</p></dd>

          </dl>

          <p>Some functions accept a <var>keyword-policy</var> &amp;key argument, which must be either <code class="common-lisp library marker">:strict</code> or <code class="common-lisp library marker">:loose</code>. <code class="common-lisp">(from 1 to 10)</code> would be valid with <code class="common-lisp library marker">:loose</code> but not with <code class="common-lisp library marker">:strict</code>, which demands <code class="common-lisp">(:from 1 :to 10)</code>.</p>

          <p><strong>Use of <code class="common-lisp library marker">:loose</code> is strongly discouraged</strong>, as it's an unnecessary and evil feature that typically results in arbitrary interning of symbols in arbitrary packages.</p>

        </section>

        <section id="parse-api">

          <h1 class="breadcrumbs-bar">
            <span class="section-relative-nav">
              <a href="#parse-api" class="anchor">⚓</a>
            </span>
            <span class="breadcrumbs">
              <a href="#">parse-number-range</a>
              <span class="crumb"><span class="s"> » </span><a href="#api">API</a></span>
              <span class="crumb"><span class="s"> » </span><a class="here">Parse API</a></span>
            </span>
          </h1>

          <dl>
            <dt><pre>Function <dfn><code class="common-lisp library function operator">parse</code></dfn> <var>range</var> &amp;key (<var>keyword-policy</var> <code class="common-lisp library marker">:strict</code>)
                          (<var>extrasp</var> nil)
                          (<var>clause-kinds-p</var> <var>extrasp</var>)
                          (<var>clause-keywords-p</var> <var>extrasp</var>)
                          (<var>clauses-alist-p</var> <var>extrasp</var>)
  =&gt; <var>from</var> <var>to</var> <var>limit-kind</var> <var>by</var> <var>direction</var>
       &amp;key <var>clause-kinds</var> <var>clause-keywords</var> <var>clauses-alist</var></pre></dt>
            <dd><p>By default, <code class="common-lisp library function operator">parse</code> returns only the 5 "fundamental" values (see above):</p>

              <dl>

                <dt><dfn><var>from</var></dfn></dt>
                <dd><p>Defaults to 0;</p></dd>

                <dt><dfn><var>to</var></dfn></dt>
                <dd><p>Defaults to <code class="common-lisp library marker">nil</code>;</p></dd>

                <dt><dfn><var>limit-kind</var></dfn></dt>
                <dd><p>Defaults to <code class="common-lisp library marker">nil</code> (unbounded);</p></dd>

                <dt><dfn><var>by</var></dfn></dt>
                <dd><p>Defaults to 1;</p></dd>

                <dt><dfn><var>direction</var></dfn></dt>
                <dd><p>Defaults to <code class="common-lisp library marker">+</code>.</p></dd>

              </dl>

              <p><code class="common-lisp library function operator">parse</code> can compute and return 3 additional pieces of information, on request:</p>

              <div class="scroll">
                <table>
                  <thead>
                    <tr>
                      <th>return value</th>
                      <th>request-keyword</th>
                      <th>description</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th><var>clause-kinds</var></th>
                      <td>:clause-kinds-p</td>
                      <td><p>The clause kinds that were present,<br />in the order they appeared in.</p></td>
                    </tr>
                    <tr>
                      <th><var>clause-keywords</var></th>
                      <td>:clause-keywords-p</td>
                      <td><p>The clause keywords that were present,<br />in the order they appeared in.</p></td>
                    </tr>
                    <tr>
                      <th><var>clauses-alist</var></th>
                      <td>:clauses-alist-p</td>
                      <td><p>Alist: (<var>clause-kind</var> . <var>clause-keyword</var>)</p></td>
                    </tr>
                  </tbody>
                </table>
              </div>

            </dd>

            <dt><pre>Function <dfn><code class="common-lisp library function operator">unparse</code></dfn> <var>from</var> <var>to</var> <var>limit-kind</var> <var>by</var> <var>direction</var> &amp;key <var>clause-kinds</var>
  =&gt; <var>range</var></pre></dt>

            <dd>
              <p>As you might have guessed, this does the reverse of <code class="common-lisp library function operator">parse</code>...</p>

              <p><code class="common-lisp library function operator">unparse</code> uses <code class="common-lisp library function operator">flags-to-keywords</code> internally and thus inherits its biases.</p>

              <p><var>clause-kinds</var> should be a list of up to 3 elements being a permutation of the clause-kinds <code class="common-lisp library marker">:from</code>, <code class="common-lisp library marker">:to</code> and <code class="common-lisp library marker">:by</code>. This determines the order that the clauses will appear in, which might matter in the presence of side-effects. <code class="common-lisp library marker">nil</code> designates the default order, <code class="common-lisp">(<code class="common-lisp library marker">:from</code> <code class="common-lisp library marker">:to</code> <code class="common-lisp library marker">:by</code>)</code>.</p>

              <p>If the list has 0 or 1 elements, then the default order is used, <code class="common-lisp">(<code class="common-lisp library marker">:from</code> <code class="common-lisp library marker">:to</code> <code class="common-lisp library marker">:by</code>)</code>.</p>

              <p>If the list has 2 elements, then those clauses will appear in the order specified but no order is specified between the other elements and these ones and between the other elements among themselves. <small>(Yeah, a less simplistic implementation would allow simpler and more useful semantics.)</small></p>

              <p>If the list has 3 elements, then the order is completely specified, explicitly.</p>
            </dd>

            <dt><pre>Function <dfn><code class="common-lisp library function operator">canonicalize</code></dfn> <var>range</var> &amp;key (<var>clause-kinds</var> <code class="common-lisp library marker">:preserve</code>)
                                 (<var>keyword-policy</var> <code class="common-lisp library marker">:strict</code>)</pre></dt>

            <dd><p>This simply feeds the results of <code class="common-lisp library function operator">parse</code> into <code class="common-lisp library function operator">unparse</code>. If <var>clause-kinds</var> is <code class="common-lisp library marker">:preserve</code>, then <code class="common-lisp">:clause-kinds-p t</code> will be specified for <code class="common-lisp library function operator">parse</code> and the resulting <var>clause-kinds</var> result will be fed to <code class="common-lisp library function operator">unparse</code>. Else, the provided <var>clause-kinds</var> is fed directly to <code class="common-lisp library function operator">unparse</code>.</p></dd>

          </dl>

        </section>

        <section id="info-api">

          <h1 class="breadcrumbs-bar">
            <span class="section-relative-nav">
              <a href="#info-api" class="anchor">⚓</a>
            </span>
            <span class="breadcrumbs">
              <a href="#">parse-number-range</a>
              <span class="crumb"><span class="s"> » </span><a href="#api">API</a></span>
              <span class="crumb"><span class="s"> » </span><a class="here">Info API</a></span>
            </span>
          </h1>

          <dl>
            <dt><pre>Function <dfn><code class="common-lisp library function operator">kind</code></dfn> <var>keyword</var> &amp;key (<var>errorp</var> t) (<var>keyword-policy</var> <code class="common-lisp library marker">:strict</code>)
                =&gt; <var>kind</var> <var>direction</var> <var>limit-kind</var></pre></dt>

            <dd><p>This function takes a <code class="common-lisp standard macro operator"><a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_loop.htm">loop</a></code> keyword and returns the following information:</p>

              <div class="scroll">
                <table>
                  <thead>
                    <tr>
                      <th>Argument</th>
                      <th colspan="3">Return values</th>
                    </tr>
                    <tr>
                      <th><var>keyword</var></th>
                      <th><var>kind</var></th>
                      <th><var>direction</var></th>
                      <th><var>limit-kind</var></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr><th>:from</th><td>:from</td><td>nil</td><td>nil</td></tr>
                    <tr><th>:downfrom</th><td>:from</td><td>-</td><td>nil</td></tr>
                    <tr><th>:upfrom</th><td>:from</td><td>+</td><td>nil</td></tr>
                  </tbody>
                  <tbody>
                    <tr><th>:to</th><td>:to</td><td>nil</td><td>:inclusive</td></tr>
                    <tr><th>:upto</th><td>:to</td><td>+</td><td>:inclusive</td></tr>
                    <tr><th>:downto</th><td>:to</td><td>-</td><td>:inclusive</td></tr>
                    <tr><th>:below</th><td>:to</td><td>+</td><td>:exclusive</td></tr>
                    <tr><th>:above</th><td>:to</td><td>-</td><td>:exclusive</td></tr>
                  </tbody>
                  <tbody>
                    <tr><th>:by</th><td>:by</td><td>nil</td><td>nil</td></tr>
                  </tbody>
                </table>
              </div>

            </dd>


            <dt><pre>Function <dfn><code class="common-lisp library function operator">flags</code></dfn> <var>keyword</var> &amp;key (<var>errorp</var> t) (<var>keyword-policy</var> <code class="common-lisp library marker">:strict</code>)
  =&gt; <var>direction</var> <var>limit-kind</var></pre></dt>

            <dd><p>This convenience function simply forwards to <code class="common-lisp library function operator">kind</code> and returns all values but the first.</p></dd>


            <dt><pre>Function <dfn><code class="common-lisp library function operator">flags-to-keywords</code></dfn> <var>direction</var> <var>limit-kind</var>
  =&gt; <var>from-keyword</var> <var>to-keyword</var></pre></dt>

            <dd>

              <p>This function does roughly the opposite of the KIND function. It returns a FROM-KEYWORD and a TO-KEYWORD (nil if unbounded) that properly indicate the supplied DIRECTION and LIMIT-KIND.</p>

              <p>There are typically multiple valid sets of answers that could be returned. This function is currently biased as follows, with no way to request a different bias:</p>

              <ul>
                <li>
                  <p>The <var>direction</var> and <var>limit-kind</var> will always be represented in the <var>to-keyword</var>, and never in the <var>from-keyword</var>, except for the following exception:</p>
                  <div class="scroll">
                    <pre class="example"><code class="common-lisp">(flags-to-keywords '- :exclusive) =&gt; :downfrom, nil</code></pre>
                  </div>
                </li>
                <li><p>:to is always returned in preference to :upto.</p></li>
              </ul>

            </dd>

          </dl>

        </section>

      </section>

    </main>

    <footer id="footer">
      <div class="back-to-top left">
        <a href="#">⬆</a>
      </div>
      <div class="main">
        <a href="http://validator.w3.org/check?uri=http%3A%2F%2Fwww.hexstreamsoft.com%2Flibraries%2Fparse-number-range%2F">✔ HTML5</a>
        <a href="https://www.hexstreamsoft.com/README">✔ Public Domain</a>
        <a href="http://jigsaw.w3.org/css-validator/validator?uri=http%3A%2F%2Fwww.hexstreamsoft.com%2Flibraries%2Fparse-number-range%2F">✔ CSS3</a>
        <a>✔ Mobile-friendly</a>
      </div>
      <div class="back-to-top right">
        <a href="#">⬆</a>
      </div>
    </footer>

  </body>
</html>
